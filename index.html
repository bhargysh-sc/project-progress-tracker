<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project Progress Tracker</title>
    <style>
      #progress-container {
        width: 100%;
        max-width: 400px;
        background: #eee;
        border-radius: 6px;
        height: 24px;
        position: relative;
        margin: 2rem auto;
      }
      #progress-bar {
        background: #4caf50;
        height: 24px;
        width: 0%;
        color: white;
        text-align: center;
        line-height: 24px;
        border-radius: 6px;
        position: absolute;
        top: 0;
        left: 0;
        transition: width 0.5s;
      }
      #progress-label {
        position: absolute;
        width: 100%;
        text-align: center;
        line-height: 24px;
        color: #222;
        font-weight: bold;
      }
      body {
        font-family: sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem;
      }
      #project-title {
        text-align: center;
        font-size: 2rem;
        margin-bottom: 1.5rem;
        color: #333;
        letter-spacing: 1px;
      }
      .milestone-bar-container {
        width: fit-content;
        min-width: 100px;
        margin-left: 0;
      }
      .milestone-bar-bg {
        background: #eee;
        border-radius: 6px;
        height: 20px;
        position: relative;
        margin-top: 4px;
      }
      .milestone-bar {
        height: 20px;
        width: 0%;
        border-radius: 6px;
        position: absolute;
        top: 0;
        left: 0;
        transition: width 0.5s;
      }
      .milestone-bar-label {
        position: absolute;
        width: 100%;
        text-align: center;
        line-height: 20px;
        color: #222;
        font-weight: bold;
      }
      #progress-bar {
        position: absolute;
        /* ...other styles... */
        overflow: visible; /* so the date can show up at the edge */
      }
      #progress-label {
        position: absolute;
        width: 100%;
        text-align: center;
        line-height: 24px;
        color: #222;
        font-weight: bold;
        z-index: 2;
      }
    </style>
  </head>
  <body>
    <main>
      <h1 id="project-title">üîê Require Password Reset Tracker</h1>
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          width: 100%;
          max-width: 400px;
          margin: 0 auto 0.5rem auto;
        "
      >
        <span id="start-date" style="font-size: 0.95em; color: #555"
          >Development Start Date: 10-06-2025</span
        >
        <span id="current-date" style="font-size: 0.95em; color: #555"></span>
      </div>
      <div id="progress-container" style="position: relative">
        <div id="progress-bar">
          <span id="progress-label">0%</span>
        </div>
      </div>
      <div id="progress-bar-date" style="position: relative; font-size: 0.95em; font-weight: bold; color: #222; margin-top: 8px; width: 100%; max-width: 400px;"></div>
      <p id="eta"></p>
    </main>
    <h2>Milestones Progress</h2>
    <div id="milestone-progress-bars">
      <!-- Milestone 1 -->
      <div class="milestone-bar-container" style="margin-bottom: 1em">
        <b id="milestone1-label-text"
          >Milestone 1: Able to display password reset page based on user
          setting</b
        >
        <div class="milestone-bar-bg">
          <div
            id="milestone1-bar"
            class="milestone-bar"
            style="background: #4caf50"
          ></div>
          <span id="milestone1-label" class="milestone-bar-label">0%</span>
        </div>
      </div>
      <!-- Milestone 2 -->
      <div class="milestone-bar-container" style="margin-bottom: 1em">
        <b id="milestone2-label-text"
          >Milestone 2: Enable password reset on next login toggle</b
        >
        <div class="milestone-bar-bg">
          <div
            id="milestone2-bar"
            class="milestone-bar"
            style="background: #2196f3"
          ></div>
          <span id="milestone2-label" class="milestone-bar-label">0%</span>
        </div>
      </div>
      <!-- Milestone 3 -->
      <div class="milestone-bar-container" style="margin-bottom: 1em">
        <b id="milestone3-label-text">Milestone 3: Production ready</b>
        <div class="milestone-bar-bg">
          <div
            id="milestone3-bar"
            class="milestone-bar"
            style="background: #ff9800"
          ></div>
          <span id="milestone3-label" class="milestone-bar-label">0%</span>
        </div>
      </div>
      <!-- Milestone 4 -->
      <div class="milestone-bar-container" style="margin-bottom: 1em">
        <b id="milestone4-label-text"
          >Milestone 4: Support password reset on next login via CSV upload</b
        >
        <div class="milestone-bar-bg">
          <div
            id="milestone4-bar"
            class="milestone-bar"
            style="background: #9c27b0"
          ></div>
          <span id="milestone4-label" class="milestone-bar-label">0%</span>
        </div>
      </div>
    </div>
    <script>
      // === CONFIGURATION ===
      const totalPoints = 56;
      const completedPoints = 4;
      const bestDays = 56;
      const worstDays = 76;
      const engineers = 2;
      const speedup = 1.3;

      // === CALCULATION ===
      const percent = Math.round((completedPoints / totalPoints) * 100);
      const remainingPoints = totalPoints - completedPoints;
      const bestRemaining = Math.ceil(
        (bestDays * (remainingPoints / totalPoints)) / speedup
      );
      const worstRemaining = Math.ceil(
        (worstDays * (remainingPoints / totalPoints)) / speedup
      );
      const weeksBest = Math.ceil(bestRemaining / 5);
      const weeksWorst = Math.ceil(worstRemaining / 5);

      // === PROGRESS BAR ===
      const progressBar = document.getElementById("progress-bar");
      const progressBarDate = document.getElementById("progress-bar-date");
      const progressContainer = document.getElementById("progress-container");

      // Set the current date text
      const now = new Date();
      const yyyy = now.getFullYear();
      const mm = String(now.getMonth() + 1).padStart(2, "0");
      const dd = String(now.getDate()).padStart(2, "0");
      // progressBarDate.textContent = `${dd}-${mm}-${yyyy}`;

      // After setting the progress bar width:
      progressBar.style.width = percent + "%";
      document.getElementById("progress-label").innerText = percent + "%";

      // Position the date below the progress bar, with its beginning at the end of the green bar
      setTimeout(() => {
        const containerWidth = progressContainer.offsetWidth;
        const progressPercent = percent / 100;
        const datePosition = containerWidth * progressPercent + 5; // Small gap after green bar
        const dateElement = document.getElementById("progress-bar-date");
        dateElement.innerHTML = `<span style="margin-left: ${datePosition}px;">${progressBarDate.textContent}</span>`;
      }, 10);


      // === ETA ===
      document.getElementById(
        "eta"
      ).innerText = `üïí Estimated time to completion: ${bestRemaining}-${worstRemaining} business days (${weeksBest}-${weeksWorst} weeks) with ${engineers} engineers.`;

      const milestoneData = [
        {
          completed: 4,
          total: 16,
          bar: "milestone1-bar",
          label: "milestone1-label",
        },
        {
          completed: 0,
          total: 16,
          bar: "milestone2-bar",
          label: "milestone2-label",
        },
        {
          completed: 0,
          total: 19,
          bar: "milestone3-bar",
          label: "milestone3-label",
        },
        {
          completed: 0,
          total: 5,
          bar: "milestone4-bar",
          label: "milestone4-label",
        },
      ];

      // === MILESTONE PROGRESS CONFIG ===
      // Set all milestone bar widths to match Milestone 1 label
      window.addEventListener("DOMContentLoaded", () => {
        const milestone1Label = document.getElementById(
          "milestone1-label-text"
        );
        const barWidth = milestone1Label.offsetWidth + "px";
        document.querySelectorAll(".milestone-bar-bg").forEach((bg) => {
          bg.style.width = barWidth;
        });

        milestoneData.forEach((ms, idx) => {
          const percent = Math.round((ms.completed / ms.total) * 100);
          document.getElementById(ms.bar).style.width = percent + "%";
          document.getElementById(ms.label).innerText = percent + "%";
        });
      });
    </script>
  </body>
</html>
